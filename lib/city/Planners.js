// Generated by CoffeeScript 1.7.1
var GrowthPlanner, NodeInterconnectivityPlanner, Planner, RoadPlanner,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Planner = (function() {
  function Planner() {}

  Planner.planners = null;

  Planner.initialize_module = function(planners_breed) {
    this.planners = planners_breed;
    return this.planners.setDefault('hidden', true);
  };

  Planner.spawn_road_planner = function() {
    return this.spawn_planner(RoadPlanner.prototype);
  };

  Planner.spawn_node_planner = function() {
    return this.spawn_planner(NodeInterconnectivityPlanner.prototype);
  };

  Planner.spawn_growth_planner = function() {
    return this.spawn_planner(GrowthPlanner.prototype);
  };

  Planner.spawn_planner = function(prototype) {
    var planner;
    planner = this.planners.create(1)[0];
    extend(planner, prototype);
    planner.init();
    return planner;
  };

  return Planner;

})();

NodeInterconnectivityPlanner = (function(_super) {
  __extends(NodeInterconnectivityPlanner, _super);

  function NodeInterconnectivityPlanner() {
    return NodeInterconnectivityPlanner.__super__.constructor.apply(this, arguments);
  }

  NodeInterconnectivityPlanner.prototype.init = function() {
    return this.msg_reader = MessageBoard.get_board('nodes_unconnected');
  };

  NodeInterconnectivityPlanner.prototype.step = function() {
    var msg;
    msg = this.msg_reader.get_message();
    if (msg != null) {
      return RoadBuilder.spawn_road_connector(msg.patch_a, msg.patch_b);
    }
  };

  return NodeInterconnectivityPlanner;

})(Planner);

RoadPlanner = (function() {
  function RoadPlanner() {}

  RoadPlanner.prototype.init = function() {
    return this.msg_reader = MessageBoard.get_board('possible_node');
  };

  RoadPlanner.prototype.step = function() {
    var msg;
    msg = this.msg_reader.get_message();
    if (msg != null) {
      return RoadBuilder.spawn_road_extender(msg.patch);
    }
  };

  return RoadPlanner;

})();

GrowthPlanner = (function() {
  function GrowthPlanner() {}

  GrowthPlanner.prototype.ticks_per_citizen = 30;

  GrowthPlanner.prototype.init = function() {
    this.msg_reader = MessageBoard.get_board('new_citizen');
    return this.ticks_since_last_citizen = 0;
  };

  GrowthPlanner.prototype.step = function() {
    return this._grow_population();
  };

  GrowthPlanner.prototype._grow_population = function() {
    this.ticks_since_last_citizen += 1;
    if (this.ticks_since_last_citizen >= this.ticks_per_citizen) {
      this.msg_reader.post_message();
      return this.ticks_since_last_citizen = 0;
    }
  };

  return GrowthPlanner;

})();
